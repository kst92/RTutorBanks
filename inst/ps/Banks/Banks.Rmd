---
output:
  pdf_document: default
  html_document: default
---
# Problemset Effect of Banks


```{r 'check_ps', include=FALSE}

user.name = '' # set to your user name

# To check your problem set, save your file (Ctrl-S) and then run the RStudio Addin 'Check Problemset'

# Alternatively run the following lines 
library(RTutor)
ps.dir = getwd() # directory of this file
ps.file = 'Banks.Rmd' # name of this file
check.problem.set('Banks', ps.dir, ps.file, user.name=user.name, reset=FALSE)
```


How important are banks for development - an RTutor interactive Problemset

Author:  Katharina Stueckelmaier



## Welcome

Welcome to this interactive RTutor Problem Set, which is part of my master thesis at the University of Ulm.
The topic is about the analysis of "How important are banks for development", based on the paper "How important are banks for development? National banks in the united states, 1870-1900" written by Scott L. Fulford. It was published in December 2015 at "The Review of Economic and Statistics". 

The paper, a supplemental appendix and data are available at the following websites:

- **paper**: https://www.mitpressjournals.org/doi/pdf/10.1162/REST_a_00546
- **appendix**: https://www.mitpressjournals.org/doi/suppl/10.1162/REST_a_00546/suppl_file/REST_a_00546-esupp.pdf
- **data**: https://dataverse.harvard.edu/dataset.xhtml?persistentId=doi:10.7910/DVN/PQ6ILM

## Exercise Content

1. Historical background

2. Overview of the data

3. Casual Effect of Banking on Production

  3.1 Correction of Standard Errors

4. Estimation with Conditional Mean 

5. Robustness Check

6. Conclusion

7. References



**Set-up of the interactive R-Tutorial**

In the following you can execute various exercises, to give you an understanding of our topic. Furthermore you will learn how to use R for solving statistical problems. I recommend to do the exercises step by step, but if you like to you can choose the order on your own, since every exercise can be solved independently.
During the exercises you can collect awards for solving tasks right. Additional you have to possibility to receive points, for answering quizzes right. 
You will fins many info boxes in the exercises. 
Good luck!

## Exercise 1 - Historical background

**U.S. Civil war, 1861-1865**


During the period of 1861 to 1865, there was a civil war in the United States. The conflict was between the northern states, so called `unionstates`, and the southern states. The southern states separated themselves from the United States to create the `Confederate States of America (CSA)`. 

The reason were several political, social as well as economical disagreements. The main controversy was the slavement of black people. As 1860 Abraham Lincoln got voted for president, the southern states separated since they were pro-slavery. Consequently it came to a war. But as the CSA weren't accepted as a state from the rest of the world, they didn't got any support. Thus they hadn't really a chance against the industrial advanced union states. 1865 the Union finally won the war and slavery were abandoned. 

*Map of USA*

In the following map of the USA, the states of CSA are marked. Just press `check`.


```{r "1___Historical_backg"}
require(maps)
library(maps)
CSA = c("alabama", "arkansas", "florida", "georgia", "louisiana", "mississippi", "north carolina", "south carolina", "tennessee", "texas", "virginia")
#namevec <- map(database = "state", col = "blue",fill=T, namesonly=TRUE)
map(database = "state", col = c("white", "blue")[1+(map(database = "state", col = "blue",fill=T, namesonly=TRUE) %in% tolower(CSA) )],fill=T )
```



Since the fight was really expensive, the government of the United States created the `National Banking Act of 1863` to resolve the financial crises.


**National Banking Act of 1863**

The National Banking Act established a national banking system, to resolve the financial crisis during the civil war. The main aim was to assure federal control over the banking system. Furthermore, they wanted to create a uniform national currency, by introducing this national banking system. But what was the difference between the new national banks and the old available state banks?

State banks received their charter from the state government, whether national banks got them from the federal government. Thus, the federal government had control over national banks, but not over state banks. 
Furthermore national banks had higher capital requirements, than state banks. To enter in a certain state, they had to have a capital stock of minimum `50.000$`. Moreover they were restricted from making real loans or lending money over ten percent of the capital of the bank to anyone, to improve liquidity. Additionally, they were regulated by the office of Comptroller of the Currency (OCC), a treasury department created during this Banking Act, who also was responsible to print all national bank notes.

Because of the growth of the national banks, many state banks transformed to national banks. Therefore, already over 1600 national banks existed and around 300 state banks were left in 1870. National bank started to be the most important financial institute in the country. After the civil war finished, the United States had an immense financial, economical as well as geographical growth. Thus, national bank got even more important since they were the only ones who could issue money directly in form of bank notes. Though they still were constrained by the minimal size of capital stock. Some counties, where they maybe could have made big profits, couldn't afford this minimum size. On the other hand, some counties had even more capital, but opened their national banks with the minimum size of capital stock.

We resume:

1. National banks had to afford a minimum capital stock, we will call this "minimum size requirement" 

2. National banks weren't allowed to have any branches


What was the benefit of having a national bank for the residents? 

One goal of national banks is that they could provide liquidity and thus working capital. Furthermore, they created a uniform bank note currency, so that international trading became easier. To stabilize this system, national banks were not allowed to take land as collateral, what was problematic for farmers. Their main investment activities were providing liquidity and moving funds, as Scott L. Fulford claims in his paper.


In the next exercises we will look, how opening a national bank in certain counties affected the development and production there. Therefore we have to respect, that national banks had to have at least a capital stock of 50.000$ . In 1900 this minimum size was reduced to 25.000$.
Our dataset contains data about the geographical location and the size of national banks in 1870, 1880, 1890 and 1900. Since there weren't any branches, we can analyse the meaning of local financial development during this period.


**County Statistics**


Before starting to analyse we want to check some variables to get used to the data. Notice, that counties with an urban population of 50.000$ or more in 1880 are excluded in this table. Thus, counties with major cities are excluded, since these counties are not constrained by the minimum capital stock requirement.

<style>
.mytable {
  border-collapse: collapse;
  margin-bottom: 15px;
}
.mytable td {
  padding: 10px 15px;
}
.mytable th {
  padding: 10px 15px;
  border-bottom: 1px solid #ddd;
}
.right-border {
  border-right: 1px solid #ddd;
}
.bigger-font-size {
  font-size: 18px;
}
</style>
  
  <table class="mytable">
  <tr>
  <th class="right-border">Variable Type</th>
  <th>1870</th>
  <th>1880</th>
  <th>1890</th>
  <th>1900</th>
  </tr>
  <tr>
  <td class="right-border">County population</td>
  <td>11.660</td>
  <td>14.703</td>
  <td>17.955</td>
  <td>21.330</td>
  </tr>
  <tr>
  <td class="right-border">Counties</td>
  <td>2.665</td>
  <td>2.745</td>
  <td>2.743</td>
  <td>2.745</td>
  </tr>
  <tr>
  <td class="right-border">Number of banks</td>
  <td>0.41</td>
  <td>0.57 </td>
  <td>1.06</td>
  <td>1.09</td>
  </tr>
  <tr>
  <td class="right-border">Distance to closest bank (km)</td>
  <td>153.2</td>
  <td>89.4 </td>
  <td>42.5</td>
  <td>40.1</td>
  </tr>
  <tr>
  <td class="right-border">Capital stock per 1.000 capita</td>
  <td>1.96</td>
  <td>2.30</td>
  <td>4.46</td>
  <td>3.46</td>
  </tr> 
  <tr>
  <td class="right-border">Total production per capita</td>
  <td>104.0</td>
  <td>80.1</td>
  <td>96.9</td>
  <td>155.0</td>
  </tr>   
  <td class="right-border">Manufacturing value per capita</td>
  <td>38.5</td>
  <td>32.3</td>
  <td>44.7</td>
  <td>60.4</td>
  </tr>   
  <td class="right-border">Farm production value per capita</td>
  <td>65.5</td>
  <td>47.8</td>
  <td>51.0</td>
  <td>94.5</td>
  </tr>   
  </table>

First, we recognize that the average county population raised for about nearly 10.000 from 1870 to 1900. Since we look at the period right after the Civil War, who caused a lot of deaths, it makes sense that the population was smaller at the beginning of our period.

The capital stock per capita increased during this period. Since there was more capital, it was also possible to open more banks. That's why the number of banks increased rapidly during this period. Accordingly, the distance to the next banks decreased for many counties. 

If we take a deeper look at the manufacturing and farm production values, we recognize that first these values decreased and then increased again. Since time effects are included, this swap is explained by the significant deflation during this period, particularly around the Resumption Act of 1875, how Scott L. Fulford stated.

Let's get a better overview of our data in the next exercise.


## Exercise 2 - Overview of the data

**How does the Minimum Capital Stock-Requirement effect the entry of banks?**

National banks had to follow up many rules to open in a certain county. One was the minimum capital stock requirement. This means, that they had to have at least a capital stock over 50.000$ to enter to a county.  But how does this distraction affected the number of entry of national banks? 

To answer this question, we will read in our first dataset. The following info box explains how data can be loaded in R.

info("read.table") # Run this line (Strg-Enter) to show info

To start with an exercise, you often must click first `edit` to work on the code. Enter the correct code and afterwards press `check`, to check your code. If you stuck at an exercise just click `hint` to get some help or `solution` to get the result.

**Task:** 

Read in your first data set `firstTable.tab` and save it under `tab1`. Replace `??` and `#`.

```{r "2___Overview_of_the___3"}
# ?? = read.table("??", sep="\t", header=TRUE)
```


First, we want to take a closer look at our dataset. One way is to check it out under `Data Explorer`, but there is also a huge amount of calls in R, which can give us a lot of informations. With `dim()` we will get the dimension of the data, meaning how many columns and how many entries the data has, and with `head()` we will see the first few rows. Let's try it out and click on `check`:

```{r "2___Overview_of_the___4"}
dim(tab1)
head(tab1)
```

Great! We have seven columns with 22552 entries in our table. 

Take a look at the second row of the displayed table. There we see, that in `1870` the national banks in the county `Autauga` in `Alabama` had a capital stock of `0`. That means that at this point of time, there hasn't been a national`bank in `Gautama`. That doesn't mean, that banks in that county didn't had any capital stock at all, it just means that they hadn't enough capital to afford a national bank.
If a bank in a county has less than 50.000$ capital stock, it is marked with `0` in our data set. Some values are marked as `NA`, meaning that we don't have any data for this case. The column `capitalstock1902` is only interesting for us, if we look at the year `1900`. In this year the minimum capital stock requirement got reduced from 50.000$ to 25.000$. So, the column `capitalstock1902` shows us how the capital amount is in `1902`. For `Autauga` the new requirement didn't make a change, they still couldn't entertain a national bank. 

With `sample_n()` we get a random selection of rows of our data, to get even more familiar with our data set.

**Task:** 

Use the function `sample_n()` in order to show a random sample of ten rows of our table `tab1`. With `set.seed(1900)` you can create a random variable, on this way it is possible to reproduce the same sample all the time.

```{r "2___Overview_of_the___5"}
#set.seed(1900)
#sample_n(??,10)
```

Now, you can see a random choice of rows of our data set `tab1`. Get familiar with the output and try to answer the next questions.


**Question**

#! addon__quiz__Ohio

**Question**

#! addon__quiz__Kentucky


In the next step, we want to know how many states and how many counties are in our dataset. Therefore we will make use of the function `unique()` and `length()`. 

`unique(x)` produces a vector with unique values of `x`, all duplicated elements will be removed. `length(y)` generates the length of vector `y`, meaning it calculates how many elements are available in `y`. 

**Task:**
Use `unique()` and `length()` to find out how many `states` and `counties` are in our data. Delete `#` and replace `??`. After finishing this task, try to answer the question.
```{r "2___Overview_of_the___6"}
# ??(??(tab1$statename))
# ??(??(tab1$countyname))

```

**Question:**

#! addon__quiz__countynum



## How did the number of national banks change between 1870 and 1900?

To analyse this, we need the data from 1870 to 1900. To reduce the size of our sample we will juts use counties with a capitalstock less than 200.000 $. Since the values in our data frame are given in 1.000 Dollar, we have to must filter out `capitalstock <= 200`. For this we make use of the function `filter` from the package `dplyr`.

info("filter()") # Run this line (Strg-Enter) to show info

**Task:**

Try to find all counties from our data `tab1`, which are documented at the period `1870 - 1900` and which had a `capitalstock` less than `200`. For this you need to use the function `filter`, therefore first load the package `dplyr`.
```{r "2___Overview_of_the___7"}
#library(??)
#dat1 = ??(??, year>= ??, year <= ??, ?? <= 200) %>% mutate(Year = as.factor(year))

```

Well done! 
`mutate()` is also a function from `dplyr`. It helps us to add new variables to our data set. So, in the task before, we also created the column `Year`. As we set it as `as.factor(year)` we defined it as a factor column. 

info("%>% Operator") # Run this line (Strg-Enter) to show info


Evtl auch f?r mutate kleine Infobox und ergebnistabelle mit neuer spalte zeigen.

We will visualize the capital stock amount over the years now. A useful package to plot this is `ggplot2` 

info("Package ggplot2") # Run this line (Strg-Enter) to show info

We want to plot our data `dat1` into a histogram to compare the amount of national banks over the years.

**Task:**
```{r "2___Overview_of_the___8"}
##??(data=??, aes(x=capitalstock, fill=year))+ ??(breaks=seq(0, 200, by =10)) + labs(x="County nationalbank capital stock ", y= "Number of counties") + facet_wrap(~Year)

```

info("facet_wrap()") # Run this line (Strg-Enter) to show info

In the plot we can see that a lot of national banks in certain counties had a capital stock of 0. Thus, they had no entry of national banks in this year. Furthermore, we recognize a bunching at 50, meaning that a lot of national banks entered with the minimum capital stock. We don't know if theses banks opened with their optimal capital amount for profit maximization, or if they opened with even a higher capital amount compared to what they would do, if no restriction were there. This leads us to the suggestion that the minimum capital requirement was constraining. 


1900 the minimum capital was reduced from 50.000 Dollar to 25.000 Dollar. How did this affect the behavior of national bank entries? As described before, in our table `tab1` we have data from 1900 and 1902. Now we want to compare them to answer the question. Therefore, we first have to filter our data and then plot them. I give you the code for that, just press `check`.

```{r "2___Overview_of_the___9"}
# Filter data `tab1`
cap1900 = filter(tab1, capitalstock <=200, capitalstock1902<=200, year==1900)
# Plot two histograms, one for the data of 1900 and one for the data of 1902
ggplot(data=cap1900)+ geom_histogram(aes(cap1900$capitalstock), breaks=seq(0, 200, by =3),col ="blue", fill="blue", alpha = .5) + geom_histogram(aes(cap1900$capitalstock1902), breaks=seq(0, 200, by =3),col ="green", fill="green", alpha = .5)+ labs(x="County national bank capital stock", y= "Number of counties")
```
The blue filled bars show the capital stock of 1900, the green bars the capital amount in 1902.
Try to answer following questions, according to the diagram:

**Question:**

#! addon__quiz__Plot1 


The number of unbanked counties (with capital stock 0) decreased a lot and a huge amount of national banks opened with 25.000$ capital stock, the new minimum size. We can assume that many counties were willing to support a national bank but didn't had that much capital stock. Thus, the could have a smaller bank before but didn't had one because of the required minimum.

Furthermore, the number of counties with national banks with a capital stock of 50.000$ increased as well. Many reduced their capital amount.

**Question**

#! addon__quiz__Plot2

Resume of the facts, why minimum capital stock was binding:

1. We have a bunching of banks with capital amount of 0 or 50.000$ capital amount.
2. Reducing the minimum size to 25.000$ leads to less bunching of banks with capital amount of 0.
3. Reducing the minimum size to 25.000$ leads to more bank openings with capital amount o 25.000$. 


## Exercise 3 - Casual Effect of Banking on Production


In the last exercise we saw that the minimum capital stock requirement constrained the entry. Thus, national banks maybe couldn't open with their optimal capital amount for profit maximization. But what is the optimal capital amount to have for entering with a national bank? 

Let's look at the simple model of profit-maximizing, if unconstrained by the minimum capital requirement. 
First, we define the optimal capital stock for a certain county as following:

$C^{*}_{ct}=\alpha\alpha_{t}P^{\theta+1}_{ct}\eta_{c}\epsilon_{ct}$

where $P_{ct}$ displays the county population, $\eta_{c}$ stands for local unobservant business conditions and $\epsilon_{ct}$ for local temporal shocks.

info("How to get the optimal capital stock equation for unconstrained banks") # Run this line (Strg-Enter) to show info

Now assume that bank could enter freely. Thus, they will try to maximize their profit and enter with their optimal capital stock amount $C^{*}_{ct}$ for a county `c` at time `t`. Remember that we defined the optimal capital stock as follow: 

$C^{*}_{ct}= \alpha\alpha_{t}P_{ct}^{\delta+1}\eta_{c}\epsilon_{ct}$.

Therefore, we can define the outcome of interest, which we want to estimate as: 

$Y^{*}_{ct} = \gamma_{c} + \gamma_{t} + \gamma_{e}C^{*}_{ct}/P_{ct}+U^{*}_{ct}$ $(1)$. 

$Y^{*}_{ct}$ displays the log production per person, our outcome of interest. $P_{ct}$ stands for the county population and certain effects are included via $\gamma_{t}$, $\gamma_{e}$ and $\gamma_{c}$.

There are two challenges we need, to estimate this equation. The first one is that banks can freely decide at what size of capital they want to enter. The second one is that the effects can differ over time. 

But as we know, banks couldn't freely open a bank in a certain county during this period. They had to open with a minimum capital stock of at least 50.000$. What is the consequence for the banks?

Some banks that could have entered with a capital stock less than the required minimum, couldn't enter at all. Thus we must differ between what banks actually do $C_{ct}$ and what they would like to do, to optimize their profit, $C^{*}_{ct}$. 

- if $C^{*}_{ct} >= 50.000 Dollar$ than for constrained counties holds $C_{ct} >= 50.000 Dollar$
- if $C^{*}_{ct} <= 50.000 Dollar$ than for constrained counties holds $C_{ct} = 0$ 

In the equation (1) we already saw the endogenous relationship. Because of the minimum requirement, banks almost can't enter with their optimal capital, we get a new effect:

$Y_{ct}-Y^{*}_{ct} = \gamma EC_{ct} / P_{ct}+U_{ct}$, where:
- $Y_{ct}$ outcome with rule
- $Y^{*}_{ct}$ outcome if banks could enter freely
- $\gamma$ displays the effect of the minimum size requirement
- $EC_{ct} = C_{ct}-C^{*}_{ct}$ excess capital

If we combine the new effect with equation $(1)$, we get:

$Y_{ct}= \gamma_{c} +\gamma_{t}+ \gamma_{e} C^{*}_{ct}/P_{ct}+ \gamma EC_{ct}/P_{ct}+e_{ct}$


Let's start with our first estimation.

The variable capitalstock50pc is the capital stock normalized by the average population of 14.755 during this period in a county. So it will be in units of adding a bank of minimum size to the county population. Furthermore, to make it easier to read, we measure this variable in units of $50.000. We defined `insample`, to select all counties, not just rural ones, and also we will just pay attention to counties with a population greater than 1000, 'tpop>1000'. 

**Task:**

First, we must read in our data set `Data2.tab` and then filter it by `insample` and create the following variable `capitalstock50pc = capitalstock_pc*14755 / 50`.
```{r "3___Casual_Effect_of"}
#Dat2 = ??("Data2.tab",header = TRUE, sep = "\t")%>%
#       ??(capitalstock50pc = capitalstock_pc*14755/50, insample = insample_allrural & tpop>1000, L.capitalstock = lag(capitalstock))

```

The first estimation we will create, will show the endogenous effect of unconstrained entry.

info("endogenous effect") # Run this line (Strg-Enter) to show info

To show the effect of unconstrained entry, we will only use counties with a bank and we will just include time effects. Before starting with our first equation, we must adapt our data set to these conditions.

**Task:**

Filter the data set in the following way. Just delete '#' and press 'check'.
```{r "3___Casual_Effect_of__2"}
#d1 = filter(Dat2, capitalstock<=500, !is.na(L.capitalstock), L.capitalstock <=500, capitalstock50pc <= 5,  capitalstock50pc>0, insample)

```

The settings of our filter-function are choosen in the following way: `capitalstock50pc` should be greater than zero, because we just look at counties with a bank. To minimize the size of our observation we make further distraction as `capitalstock<=500` and for the normalized variable `capitalstock50pc<=5`.

info("linear model lm()") # Run this line (Strg-Enter) to show info

**Task:**

Estimate our data set `d1` with `lm()`. We want to get the effect between log-production per person `ln_tval_pc` and `capitalstock50pc`. Furthermore, we want to include the time fixed effect, which we will do with `factor(year)`. To display the result, we use `summary()`.

```{r "3___Casual_Effect_of__3"}
#summary(??(ln_tval_pc~ ?? + factor(year), data = d1))
```

Great! As a said before, this estimation should generate the endogenous effect of unconstrained counties. Let's check this assumption. The `cor(x,y)` function calculates the correlation coefficient. Press `check`.

```{r "3___Casual_Effect_of__4"}
cor(d1$ln_tval_pc, d1$capitalstock50pc,use="complete.obs" )
```

The correlation coefficient between `ln_tval_pc`and `capitalstock50pc` is positive and thus not equal to `0`. This means endogeneity is given. 

Before interpreting the result of our first estimation, let me explain another way to estimate linear models. 

info("linear model with fixed effects") # Run this line (Strg-Enter) to show info

**Task:**

Estimate `ln_tval_pc~capitalstock50p` using fixed effect `year` on the base of the data set `d1`. Use `felm()`, but first load the package `lfe`.

```{r "3___Casual_Effect_of__5"}
#library(??)
#summary(??(ln_tval_pc~capitalstock50pc |year , data = d1))
```


As you can see, we get the same result for using the function `lm` compared to `felm`. Since `felm` is faster and has an easier way to define the equation and effects, we will use `felm` in the future.
Let's take a closer look at our result.
The estimated value for `capitalstock50pc` is `0.061152`, that means our capital per capita is `6%`. But what does it mean? Adding a bank to a county, will lead to a higher output per person of 6%. Remember that we just took care of counties with a bank and also didn't related to the minimum capital requirement, in this estimation. 
During the next estimations, I will explain you more deeply how to interpret the values of such results.

Next, we will include the minimal capital stock requirement of 50.000$ and calculate the effect of entry. Therefore, we compare counties that don't have a bank to counties with a bank, which opened at the minimum size. 
To get this effect, it is necessary to filter out all counties with a capital amount of less than $50.000.

**Task:** 

Filter `capitalstock<=50` and equal to that filter as well `capitalstock50pc<=5`. Again, our data selection should be in our `insample`, remember that this shows us all counties with population greater than 1000. Afterwards estimate the regression `ln_tval_pc ~ capitalstock50pc`.

```{r "3___Casual_Effect_of__6"}
#d2 = filter(Dat2, insample, ??, ??)
#summary(felm(ln_tval_pc~?? |year , data = ??))
```

Well done! Now I will show you how to interpret the result of a `felm()` regression. 

<style>
.mytable {
  border-collapse: collapse;
  margin-bottom: 15px;
}
.mytable td {
  padding: 10px 15px;
}
.mytable th {
  padding: 10px 15px;
  border-bottom: 1px solid #ddd;
}
.right-border {
  border-right: 1px solid #ddd;
}
.bigger-font-size {
  font-size: 18px;
}
</style>
  
  <table class="mytable">
  <tr>
  <th class="right-border">Call </th>
  <th>`Call: felm(formula = ln_tval_pc ~ capitalstock50pc | year, data = Dat_A)`
displays our regression call.</th>
  </tr>
  <tr>
  <th class="right-border">Residuals</th>
  <th>Residuals are the difference of the observed response value and the predicted value of the model. They can help us to check, whether our model is good enough. Therefore, they should be normal distributed with mean value around `0`. To check this, following is necessary: The median should be around `0`, and the first and third Quantile should be symmetric about `0`. In our case these conditions are true.</th>
  </tr>
  <tr>
  <th class="right-border">Coefficients</th>
 
  <th>In this part you will find the values of the regression-equation. 

*Estimate:*  this is the slope if we add a minimum size bank to a county. In our case it shows us how much more capital per capita we will get.

*Std.Error:* the standard error "measures the average amount that the coefficient estimates vary from the actual average value of our response variable" [https://feliperego.github.io/blog/2015/10/23/Interpreting-Model-Output-In-R]

*t value:* shows how much standard deviation the estimated coefficient is away from `0`. If the value is far away from `0`, it's better because than we could reject the Null-Hypothesis. If this is the case, we can assume that there is a relationship between our log-production per person and the capital stock amount. 

*Pr(>|t|):* here we find the p-value for a T-Test. Our p-value is smaller then the significance value `0.001`. Thus we can reject the Null-Hypothesis again.</th>
  </tr>
  <tr>
  <th class="right-border">Residual standard error</th>
  <th>Here we get information about the variance of the residuals.</th>
  </tr>
  <tr>
  <th class="right-border">Multiple R-squared</th>
  <th>Shows how good the regression fits in the data.</th>
  </tr>
  <tr>
  <th class="right-border">F-Statistic</th>
  <th>Measures the relationship between `ln_tval_pc` and `capitalstock50pc`. The higher this value is, the better the relationship is.</th>
  </tr>
  <tr>
  </table>





Now you know how to read such outputs. Let's check your new knowledge with a little quiz.

***Question:***

#! addon__quiz__Output


#! addon__quiz__NullHypothesis


#! addon__quiz__NullHypothesis2

Well done! Getting a new bank in a county will lead to a higher output per person of `21.8%`, respecting the minimum capital requirement of $50.000 and including time effects.


In the next step we will include an indicator for whether a county has a bank or not. Now we want to estimate how production per person depends on the capital amount of a county. For that we will use the presence of a bank in a county.

**Task:**

First create a new data set d3, based on our data set Dat2. Here we want to take counties with a `capitalstock <= 5` and counties which were included in the predefined value `insample`. Afterwards create a regression where we compare the relationship between `ln_tval_pc` and `banks50c`. Include `year` as fixed effects.
```{r "3___Casual_Effect_of__7"}
#d3 = ??(Dat2, ??, ??)
#summary(??(?? ~ ?? | ??, data=d3))

```

Production per person gets `37%` higher if we use the presence of banks as an indicator. 

Now you have seen three different regression. But how can we compare them to our main equation $Y_{ct}= \gamma_{c} +\gamma_{t}+ \gamma_{e} C^{*}_{ct}/P_{ct}+ \gamma EC_{ct}/P_{ct}+e_{ct}$ (2)?

For comparing our regressions we use the function `stargazer()` from the same named package.

info("stargazer()") # Run this line (Strg-Enter) to show info

Press `check` to compare the results.

```{r "3___Casual_Effect_of__9",results='asis'}
library(stargazer)
stargazer(felm(ln_tval_pc ~capitalstock50pc | year, data= d2),
          felm(ln_tval_pc ~banks50c | year, data=d3),           
          felm(ln_tval_pc ~banks50c | year, data=d3),        
          type="html",
          digits=3,
          report="vcsp*",
          omit.stat="ser",
          model.numbers=FALSE,
          column.labels=c("Capital>= 50 ", "Capital <=50 ", "Indicator for bank "))
```

In the first regression we calculated, that the production per person is around `6%` if a bank was added. Here we calculated the endogenous effect $\gamma_{e}$.
In the second regression we compared the capital stock per capita of counties with a bank of 50.000$ capital and without a bank. Counties with a bank are much more productive, as we calculated the production per person raises about `22%` if a county has at least one bank. This assumption is strengthened by our last regression. Here we have seen that the production per person is `37%` higher by including an indicator, whether the county has a bank or not.
In these regressions we just included time effects. Next, we want to include all fixed effects.



## Fixed effects

To calculate estimations with fixed effects R offers the package `plm`, a linear model for panel data. We will use the function `plm` out of this package. This function uses the known `lm`function to estimate panel data. But with it we can set estimation models like pooled OLS "pooling", first difference "fd" or fixed effects "within" of which we will make use. The structure of a `plm`- function is:
`plm(formula, data, subset, weights, na.action, effect = c("individual", "time", "twoways", "nested"), model = c("within", "random", "ht", "between", "pooling", "fd"))`

If you want to learn more about the `plm`-package look through the following link:

"https://cran.r-project.org/web/packages/plm/plm.pdf".

In the last exercise we made three estimations with time effects, to check how the adding of a bank to a certain county affects the production per person there. Our result was, that if we add a bank at minimum size to a county, we receive a higher output per person. There we differed between counties which had already a bank and counties without any bank before.
Now we want to include as well county fixed effects as well, thus all fixed effects of our estimation are included. To do this we use `plm`. 
Let's start with our first regression, where we just use counties that have at least one bank.

**Task**

Use the `plm`-function to estimate the effect between `ln_tval_pc` and `capitalstock50pc`. Since we want fixed effects to be included, use `model="within"` and `effect="twoways"`. Make use of our predefined data set `d1`.

```{r "3___Casual_Effect_of__10",results='asis'}
#library(plm)
#plm1 =(??(??~ capitalstock50pc + factor(year), model="??", effect="twoways",data = d1))
#stargazer(plm1, type="html", digits=3, report="vcsp*", omit.stat="ser", model.numbers=FALSE))
```

Perfect! Including fixed effects leads to a higher output per person for about `2.4%` when adding a minimum size bank to a county with at least one bank. Comparing the result to our result without fixed effect of `6%`, that means much less production per person. This can be explained by respecting that "banks are attracted to more productive areas", like Fullford says. 

In the next step we will estimate how much more output a county will get by adding a bank, independent if they had a bank before or not. We will include fixed effects and then compare our result to the one without any effects. I will use again `plm` for the estimation and `stargazer` to compare the results. 

**Task**

Delete `#` and press `check`.

```{r "3___Casual_Effect_of__11",results='asis'}
#stargazer(plm(ln_tval_pc~ capitalstock50pc + factor(year), model="within", effect="twoways", data =d2), felm(ln_tval_pc ~capitalstock50pc | year, data= d2),type="html", digits=3, report="vcsp*", omit.stat="ser", model.numbers=FALSE)
```

Counties with banks are more productive, than counties without banks. Respecting the fixed effects, production per person is `17.8%` higher.

In the last step we repeat this procedure to our last regression.

**Task**

Delete `#` and press `check`

```{r "3___Casual_Effect_of__12",results='asis'}
#stargazer(plm(ln_tval_pc~ banks50c + factor(year), model="within", effect="twoways", data =d3), felm(ln_tval_pc ~banks50c | year, data= d3),type="html", digits=3, report="vcsp*", omit.stat="ser", model.numbers=FALSE)
```

Using an indicator for banks and including fixed effects, counties with a bank will have around `11.5%` more production per person than counties without a bank. Since endogeneity is important we must include the fixed effects, which leads to lower estimate results. 

Comparing the results of these three regressions, we can approach the casual effect of entry. We've got the endogenous effect $\gamma_{e}$ for equation (2) as `2.5%`. Combining our results from the second and third regression, we can suggest the combined endogenous effect and the effect of entry at the minimum size $\gamma+\gamma_{e}$ for equation (2). Thus the effect of the entry of national bank at the minimum size in an unbanked county is around `8%`. 



## Exercise 3.1 Correction of Standard Errors

In this exercise we will check if our regression models fulfil the econometric analysis assumptions. Meaning that the disturbances are uncorrelated and have the same variance.

Our data is arranged in several groups, formal called *clusters*. Clustered data is characterized by independence across clusters and correlation within clusters [Ullah and Giles, 2017, Chapter 1]. One cluster in our data set is `countynum`, numbers for several counties in the USA. It is possible, that the production per person in counties close to each other is not independent from each other but has a similar value. Thus, we could have geographical correlation. To disclaim such correlation, we will cluster our analysis at the `countynum` level.

Before starting with this exercise, we will load our data from the last exercise again. Just press `edit` and `check`.
```{r "3_1_Correction_of_St"}
Dat2 = read.table("Data2.tab",header = TRUE, sep = "\t")%>%
     mutate(capitalstock50pc = capitalstock_pc*14755 / 50,insample = insample_allrural & tpop>1000,     L.capitalstock = lag(capitalstock))
d2 = filter(Dat2, insample, capitalstock<=50, capitalstock50pc <= 5)

```

First, we want to know how many clusters we will have in this analysis. 

**Task**

We want to find out the unique quantity of `countynum`. Replace `??` and delete `#`.
```{r "3_1_Correction_of_St__2"}
# length(??(Dat2$??))

```

**Question**

#! addon__quiz__Cluster

As we can see, we have a huge number of clusters in our data. Knowing this, we want to create a regression with `cluster robust standard errors`.

info("Cluster Robust Standard Errors:") # Run this line (Strg-Enter) to show info


With the function `felm()` we used before, it is achievable to cluster. 

info("Clustering with felm()") # Run this line (Strg-Enter) to show info

We will perform now a regression with clustered standard errors, using our second regression from Exercise 2.1. There we compared the capital stock of counties with a minimum size bank and without a bank. Remember that the response variable is `ln_tval_pc` and the explanatory variable is `capitalstock50pc`. Furthermore, we used the data `d2` and had as fixed effect `year`. 

**Task**

Perform a regression with standard errors clustered at the `countynum` level and use `felm()`.  Replace `?` and delete `#`. 
```{r "3_1_Correction_of_St__5"}
#summary(felm(ln_tval_pc ~capitalstock50pc | year | 0 | ?? , data=d2)) 

```



Output hier noch erklaren


## Homoscedasticity

In the next step we want to check if our residuals have the same variance, called **Homoscedasticity**, by using the **Breush-Pagan-test**.

info("Homoscedasticity & BP-Test") # Run this line (Strg-Enter) to show info


To perform the BP-Test we can use `bptest()` from the package `lmtest`. The function looks like `bptest(var1~var2, data=dat)`. 

**Task**

Replace `?` and delete `#`. 
```{r "3_1_Correction_of_St__6"}
#Load package for the BP-Test
##library(?)

#Breusch-Pagan test
## ?(ln_tval_pc ~capitalstock50pc, data=d2)

```

Great! The output gives us an information about the kind of test which was performed, here `studentized Breusch-Pagan test`, the data which was used and the statistics of the test. `BP` shows the value of the test statistic, `df` the degrees of freedom an `p-value` displays the p-value. 

#! addon__quiz__BP-test


With the p-value `0.8196` we won't reject the null hypothesis at a significance level of $\alpha=5$%. Thus, we can assume homoscedastic for our residuals. Perfect! 

Now, we just have to check whether our estimation variables are correlated or not.

info("Correlation") # Run this line (Strg-Enter) to show info

```{r "3_1_Correction_of_St__7"}
cor(d2$ln_tval_pc, d2$capitalstock50pc, use="complete.obs" )
```

Hence, our regression models fulfil the econometric analysis assumptions, the disturbances are uncorrelated and have the same variance. 



## Exercise 4. Estimation with conditional mean

In this section I will show you, how to estimate with conditional mean to get a less sensitive estimation. 

Remember our equation

$Y_{ct}= \gamma_{c} +\gamma_{t}+ \gamma_{e} C^{*}_{ct}/P_{ct}+ \gamma EC_{ct}/P_{ct}+e_{ct}$.


The main problem here was that we couldn't observe the optimal capital stock $C_{ct}^{*}$. We will now calculate the mean optimal capital stock from the density for each county-decade $C_{ct}^{*^{mean}}$ and then replacing $C_{ct}^{*}$ by it. As simple as this sounds, we first have to check whether estimating on this way will lead to the right estimation of $\gamma$. 

What conditions do we have to fulfill?

1. Using the mean optimal capital stock shouldn't change the structure of the problem: Since the relationship between the capital stock per person and the output per person is linear, we will get a linear unbiased estimator $\gamma$ estimating with $C_{ct}^{*^{mean}}$.

2. The conditional mean must be unbiased: We define $C_{ct}^{*}= C_{ct}^{*^{mean}} + u_{ct}$, where $u_{ct}$ is the error term. If $E[u_{ct}|C_{ct}^{*^{mean}}]= 0$ holds, the error term is independent of the observed value. Thus it is correlated   with the true value. Assuming this, replacing $C_{ct}^{*}$ with $C_{ct}^{*^{mean}}$ will still estimate $\gamma$   without bias.

Under this assumptions, we can use conditional mean for our estimations.

Since our data set is huge and has a lot of missing values, I will show you how to estimate with conditional mean with a smaller sample. Afterwards I will present the results from Fulford for the whole data set. He uses multiple imputations to fill the missing values with simulated values. If you interested in the concrete way, please have a look at the Stata-Code from the file "National_bank_analysis3.do" which you can find here: 
https://dataverse.harvard.edu/dataset.xhtml?persistentId=doi:10.7910/DVN/PQ6ILM.



We will just look at the state `Mississippi`, which contains only rural counties and was also one of the  CSA states during the civil war. Have a look where Mississippi is located. Press `check`.

```{r "4__Estimation_with_c"}
require(maps)
library(maps)
Mis = c("mississippi")
map(database = "state", col = c("white", "blue")[1+(map(database = "state", col = "blue",fill=T, namesonly=TRUE) %in% tolower(Mis) )],fill=T )
```

First, we will not include information  about 1902 in our estimation. I calculated the mean of excess and optimal capital stock and normalized both, such that they are in units of adding a bank of minimum size to the county. 

**Task:**

Read in the data set `Mississippi.tab`. Find the mistake in the following code and delete `#`.

```{r "4__Estimation_with_c__2"}
# Mississippi = open.csv("Mississippi.csv", header=TRUE, sep="\t")
```



Great! In the next step we will have a look at our new created mean variables. `Mopt_capital_pc` displays the mean of the optimal capital amount. Notice that the mean is calculated for each county and each decade. `Mexcess_capital_pc` shows the mean excess capital for each county and each decade. Excess capital displays the difference between the actual capital stock and the optimal capital stock, $EC_{ct}= C_{ct} - C_{ct}^{*}$. Press `check` to get a small overview of these variables.

```{r "4__Estimation_with_c__3"}
set.seed(50)  #setting a seed to get always the same random sample
sample_n(select(Mississippi, year, countyname, Mexcess_capital_pc, Mopt_capital_pc, capitalstock50pc),10)
```

Have a look at the first line of our output. The national banks in the county `Prentiss` had in `1890` a capital stock of `0`, meaning there was no national bank in Prentiss at this time. Thus the mean excess capital amount is $42900000-0 = -4290000$, as shown in the table. As you can see, the shown counties didn't had a national bank during the displayed period. We want to check now, how many counties had a national bank in Mississippi during the observed period. Be aware that some values are missing, and that for each county we have data for each decade. 

**Task:**
`capitalstock50pc` shows the capital stock normalized by the average population of 14755 during this period in a county. Thus, if it is `0` we know, that a county didn't had a national bank. If it is something positive, we know that the county had national banks, which opened with a specific capital stock. How can you check, how many counties in `Mississippi` didn't had a national bank in our sample? Try to work with the variable `capitalstock50pc`.

```{r "4__Estimation_with_c__4"}
#??(Mississippi$capitalstock50pc)
```

**Question:**

#! addon__quiz__NumberOfUnbankedCounties

In Mississippi not many counties could afford a national bank during the period of 1870 to 1900. Maybe they were restricted by the minimum capital stock size of 50.000$ or they didn't had capital at all to open national banks.
Nevertheless we will make estimations with conditional mean to check how extra banking could have affect the development in Mississippi.

We will do the estimations on basis of a one-period lag. On this way we can suggest continuing growth effects and not just single-level effects. To do that, we have to define the lags for our important variables `Mopt_capital_pc` and `Mexcess_capital_pc`. Furthermore, we will use in all regressions time and county fixed effects. Normally we would also cluster for states, but since we just look at the state Mississippi we can skip this step.

Let's start by defining the lag-variables. Just press `check`.

```{r "4__Estimation_with_c__5"}
Mississippi = mutate(Mississippi, 
                     LMopt_capital_pc=lag(Mopt_capital_pc), LMexcess_capital_pc= lag(Mexcess_capital_pc))
```


Perfect! Now we can start with the first estimation, where we check the log total production value per capital in Mississippi.

**Task:**
Create an estimation for `ln_tval_pc ~ LMopt_capital_pc + LMexcess_capital_pc` with `felm`. County and time fixed effects should be included. Delete `#` and replace `??`.
```{r "4__Estimation_with_c__6"}
#summary(??(ln_tval_pc ~ LMopt_capital_pc + ??|year+countynum, data=Mississippi))

```

The important variable in this estimation is `LMexcess_capital_pc`. It shows us, how much extra banking would effect the production per person including a one-period lag. Thus, opening a national bank in Mississippi would increase production per person for about `12.3%`.

What about `LMopt_capital_pc`? This variable displays the mean optimal capital stock over all decades and all counties in Mississippi. In our estimation it shows the impact of optimal capital stock per capita. Thus, the coefficient on optimal capital per person in Mississippi is about `26.7%`. 

We checked how opening a national bank in Mississippi effects the total production per capita. But total production can be separated in manufacturing and agriculture. Let's first check the effect of manufacturing production.

**Task:**
In the following I show you a code how to measure the above described effect. Check the code and find the mistake.
```{r "4__Estimation_with_c__7"}
#summary(felm(ln_manuf_val_pc + LMopt_capital_pc + LMexcess_capital_pc|year+countynum, data=Mississippi))

```

**Question:**

#! addon__quiz__EffectManufacturing

Now we want to compare, how the effect of banking is for farm production. Press `check`.

```{r "4__Estimation_with_c__8"}
summary(felm(ln_farmprod_val_pc ~ LMopt_capital_pc + LMexcess_capital_pc|year+countynum, data=Mississippi))
```

Gaining a national bank in Mississippi leads to a negative result for farm production in Mississippi. How could this be? First, remember that national banks couldn't lend land and the only way to help agriculture was to provide capital to farmers. As we have seen before, there hasn't been many national banks in Mississippi, thus farmer couldn't be promoted by them. Second, the manufacturing could have played a more important role in Mississippi than agriculture. Thus, national bank would have more support manufacturing production.

In the whole analysis we didn't took notice of the reduced minimal capital stock requirement from 1900. Now, we want to include this information. Therefore, we have to read in a data set with information about 1902. Afterwards we will calculate the needed lags again. Remember that this new rule was published in 1900, but the effect of this change are documented in our data set in the year of 1902.

Press `check`.

```{r "4__Estimation_with_c__9"}
#load file
Mississippi1902 = read.csv("Mississippi25.csv", header=TRUE, sep="\t")
#create new variables
Mississippi1902 = mutate(Mississippi1902,
                         LMopt_capital_pc=lag(Mopt_capital_pc), LMexcess_capital_pc= lag(Mexcess_capital_pc))
```

Let's start again to estimate the banking effect on the total production per capita, including the new requirement of 1900.

**Task:**

Create a regression for `ln_tval_pc ~ LMopt_capital_pc + LMexcess_capital_pc`. Year and county fixed effects should be included. Use again `felm` for the estimation. Delete `#` and replace `??`.  
```{r "4__Estimation_with_c__10"}
#summary(??(ln_tval_pc ~ LMopt_capital_pc + LMexcess_capital_pc| ?? + countynum, data=Mississippi1902))

```

Including the information about 1902, the total production per person increases for about `20.77%` if opening a new national bank in Mississippi. Since `20.77% > 12.3%`, the new lower minimum capital requirement of 25.000$ introduced in 1900 has a higher effect on the production than before. We can assume that a lot of national banks were constrained by the minimum size of 50.000$ and couldn't open a bank in Mississippi before the minimum stock was reduced. In the following we check the effect for manufacturing and farm production including the information from 1902. I will give you the code, just press `check`.

```{r "4__Estimation_with_c__11"}
summary(felm(ln_manuf_val_pc ~ LMopt_capital_pc + LMexcess_capital_pc| year + countynum, data=Mississippi1902))
summary(felm(ln_farmprod_val_pc ~ LMopt_capital_pc + LMexcess_capital_pc| year + countynum, data=Mississippi1902))
```

The increment of manufacturing is with the information of 1902 around `5.86%`, without the information it was `6.2%`. The result for the improvement of farm production per person is still negative but is now higher than before `-13,3% < -7.75%`. 

How can we interpret this result? Before the minimum capital stock were lowered, we assumed that Mississippi focused on manufacturing rather than on agriculture. With the information about the 25.000$ capital stock requirement, we can see that they still promote industrialization but also focus now on farm production. The number of national banks raised, thus they had more working capital for farmers as well. Therefore the farm production could increase. But after all, we can still assume that Mississippi was a state of manufacturing. 

Mississippi is a small state in the United States. Thus we can't make a conclusion for the whole USA based in our analysis. Since Fullford did the analysis for the whole country by using the county conditional mean, we will take a look at his results. You can find the following shown results in his paper on page 934. Notice that a one-period lag and information about 1902 are included. Furthermore, year and county fixed effects are respected. Excess capital and optimal capital per capita are measured again in units of 50.000$ per average population of 14.755, thus they show the effect of adding a bank of minimum size to a county. Be aware that just rural counties are included in the estimation.


<style>
.mytable {
  border-collapse: collapse;
  margin-bottom: 15px;
}
.mytable td {
  padding: 10px 15px;
}
.mytable th {
  padding: 10px 15px;
  border-bottom: 1px solid #ddd;
}
.right-border {
  border-right: 1px solid #ddd;
}
.bigger-font-size {
  font-size: 18px;
}
</style>
  
  <table class="mytable">
  <tr>
  <th class="right-border"> </th>
  <th>Log Total Production Value per Capita x 100</th>
  <th>Log Manufacturing Value per Capita x 100</th>
  <th>Log Farm Production Value per Capita x 100</th>
  </tr>
  <tr>
  <th class="right-border">Excess capital per capita</th>
  <th>9.872</th>
  <th>5.828</th>
  <th>13.160</th>
  </tr>
  <tr>
  <th class="right-border">Optimal capital per capita</th>
  <th>3.451</th>
  <th>2.440</th>
  <th>1.988</th>
  </tr>
  <tr>
  </table>
  

Study the table and try to answer the following questions.

**Questions:**

#! addon__quiz__Table1

#! addon__quiz__Table2


Great! Extra banking with minimum capital stock would increase total production per person for about `9.87%`. The impact of optimal capital stock per capita lays here around `3.45%`, which is very close to our result in Exercise 3 (first regression with fixed effect, calculating the effect for counties with at least one bank). Thus, the effect of gaining a minimum size banks is substantially larger than the endogenous effect how Fullford claims. Knowing this, we can also suggest that the pure entry effect of a national bank is really large. 

If we compare the effect of manufacturing per person being around `5.82%` and effect on the farm production of `13.16%`, we can assume that the increase of total production per person is the result of the high increase of farm production per person. In the analysis counties with major cities are excluded. In such areas manufacturing played a bigger role than in rural counties, and we can assume that in such counties national banks may have promoted manufacturing more. All in all, we can claim that national banks increased production per capita compared to unbanked counties.



## Exercise 5. Robustness Check

Robustness checks play an important role in the regression analysis. While regression analysis tries to find the relationship between a dependent variable and one ore more independent variables, robustness checks tries to figure out if the regression model is robust to changes. It will check how the conclusions change when the assumption changes.

In this exercise we will check our results for robustness. Therefore we will restrict our sample in various ways.

### Not including 1902

One thing we have to worry about, is that counties who are far away from getting a bank can influence the results. The information from 1902 about banking with the lower minimum capital stock of 25.000$, gives us an overview of the distribution of optimal capital for counties with no banks. Not using the informations from 1902 displays how the functional form of our estimation is responsible for the results.

In Exercise 4 we estimated the dependence between production per person and banking in Mississippi. Once we used the informations from 1902 and one time didn't included them. We will now compare the results. First, load again the data set. Find the two mistakes in the following code.  

```{r "5__Robustness_Check"}
#Data without information from 1902:

#Mississippi = read.csv("Mississippi.csv", header=TRUE, sep="\t")+
#              mutate(LMopt_capital_pc=lag(Mopt_capital_pc), LMexcess_capital_pc= lag(Mexcess_capital_pc))

#Data with information from 1902:

#Mississippi1902 = read.csv("Mississippi25.csv", header=TRUE, sep="\t")%>%
#              filter(LMopt_capital_pc=lag(Mopt_capital_pc), LMexcess_capital_pc= lag(Mexcess_capital_pc))
```


**Task:**

Compare the results of the estimation `ln_tval_pc ~ LMopt_capital_pc + LMexcess_capital_pc`, once using informations from 1902 and once not. Delete `#` and replace `??`.

```{r "5__Robustness_Check__2",results='asis'}
#??(felm(ln_tval_pc ~ LMopt_capital_pc + LMexcess_capital_pc|year+countynum, data=Mississippi),           felm(ln_tval_pc ~ LMopt_capital_pc + LMexcess_capital_pc|year+countynum, data=Mississippi1902), type="html", digits=3, report="vcsp*", omit.stat="ser", model.numbers=FALSE, column.labels=c("Not including 1902 ", "Including 1902 "))
```



The estimation result with the information of 1902 is higher then without it. Not using the information of 1902, counties with no bank could be anywhere below $C^{T}$, the optimal capital. Maybe they are very near to gaining $C^{T}$ and restricted by the requirement of opening a national bank. But maybe they are far away of the optimal capital and wouldn't even open a national bank, if there hasn't been the capital stock requirement. Including now the extra informations from 1902, we can claim that counties without a bank are even more far away of gaining a national bank since their capital stock must be now smaller than $C^{T}_{25}$, the optimal capital with the 25.000$ minimum capital stock rule. These counties are now far away of the entry point and don't influence our result anymore. We can suggest now that the estimation is robust.

We want to check robustness also for our whole data set and thus for the estimation results for the whole USA. Therefore we will have a look at the results of Fullford, which you can find on page 935 in his paper. In the estimation there are just `rural counties` included and and `one-period lags`. Furthermore, I will just display the result for the `mean excess capital per capita`.

<style>
.mytable {
  border-collapse: collapse;
  margin-bottom: 15px;
}
.mytable td {
  padding: 10px 15px;
}
.mytable th {
  padding: 10px 15px;
  border-bottom: 1px solid #ddd;
}
.right-border {
  border-right: 1px solid #ddd;
}
.bigger-font-size {
  font-size: 18px;
}
</style>
  
  <table class="mytable">
  <tr>
  <th class="right-border">Dependent variable</th>
  <th>Using 1902</th>
  <th>Not Using 1902</th>
  </tr>
  <tr>
  <th class="right-border">Log total production per capita x 100</th>
  <th>10.077</th>
  <th>11.084</th>
  </tr>
  <tr>
  <th class="right-border">Log manufacturing production per capita x 100</th>
  <th>5.828</th>
  <th>3.706</th>
  </tr>
  <tr>
  <th class="right-border">Log farm production per capita x 100</th>
  <th>13.162</th>
  <th>13.599</th>
  </tr>
  <tr>
  </table>
  

Study the table. Comparing the results between including 1902 and not, we see that they nearly didn't change. We can claim the same things as for the Mississippi estimation. The counties with no banks will be even more far away from the entry point including information of 1902, than not. Thus, many of them will not be included in the estimation when using 1902. The amount of included counties in this case is smaller compared to not using 1902. That means, the estimation with not using 1902 has more counties included with no precise information about them. But still this will not change the results. The estimation approach is robust.


### Excluding the South

In our estimations we always used rural counties and excluded counties with major cities. But the rural counties can also be separated in union rural counties and not union rural counties. 

After the civil was finished, the states of the CSA were again taken over by the USA. But they were really poor after the war, and a lot of people there had to die during the war. Thus, the population were there on a minimum. Furthermore, they were really poor banked. Remember our analysis from Mississippi, which was not a union state, there we saw that the state had a lot of unbanked counties. Our estimation could be influenced by this poorly banked states in the `South`. Also, there were some counties in the `West` with a low number of banks and a small population, compared to the counties in the `North` and `Mid-West`. Thus, we want to check the results by excluding the South and the West and just take the union rural states in the sample. Have a look, at the union states on the following map. Press `check`.

```{r "5__Robustness_Check__3"}
require(maps)
library(maps)
Union = c("california", "connecticut", "delaware", "illinois", "indiana", "iowa", "kansas", "kentucky", "maine", "maryland", "massachusetts", "michigan", "minnesota", "missouri", "nevada", "new hampshire", "new jersey", "new york", "ohio", "oregon", "pennsylvania", "rhode island", "vermont", "west virginia", "wisconsin")
#namevec <- map(database = "state", col = "blue",fill=T, namesonly=TRUE)
map(database = "state", col = c("white", "blue")[1+(map(database = "state", col = "blue",fill=T, namesonly=TRUE) %in% tolower(Union) )],fill=T )
```




Therefore, we look at the results of the estimation with conditional mean just using union rural counties, as Fullford displayed.

<style>
.mytable {
  border-collapse: collapse;
  margin-bottom: 15px;
}
.mytable td {
  padding: 10px 15px;
}
.mytable th {
  padding: 10px 15px;
  border-bottom: 1px solid #ddd;
}
.right-border {
  border-right: 1px solid #ddd;
}
.bigger-font-size {
  font-size: 18px;
}
</style>
  
  <table class="mytable">
  <tr>
  <th class="right-border">Dependent variable</th>
  <th>Using 1902</th>
  <th>Not Using 1902</th>
  </tr>
  <tr>
  <th class="right-border">Log total production per capita x 100</th>
  <th>8.890</th>
  <th>10.574</th>
  </tr>
  <tr>
  <th class="right-border">Log manufacturing production per capita x 100</th>
  <th>10.560</th>
  <th>10.308</th>
  </tr>
  <tr>
  <th class="right-border">Log farm production per capita x 100</th>
  <th>16.198</th>
  <th>14.415</th>
  </tr>
  <tr>
  </table>

As you can compare the upper table, the results excluding the South nearly didn't change.

**Question:**
#! addon__quiz__Robustness

Compare as well the result above, between including informations from 1902 and not. Again, the results largely unchanged and the robustness we claimed before is holding for only union states as well.


### State Banks

Our estimation shows the effect of minimum size banking of national banks. But the effect of providing services of a national banks is not necessarily the effect of any access to banking, like Fullford presents. 
National banks weren't the only financial institutes in the United States during the period of 1870 to 1900. There also have been state banks. With the establishment of national banks the number of state banks decreased to a minimum. Until the late 1880s there were just a few state banks left. This means during this time our estimation couldn't be effected of state banks, since there were too few of them. But after 1890 many state banks entered and were in real competition with national banks. State banks weren't restricted by the minimum capital stock requirement. Thus, they could offer lower capital stock requirements and enter places where national banks couldn't. Since the minimum capital stock requirements of state banks weren't uniform, they were able to offer low minimums to places with no bank. Therefore, such counties were able to get banking somehow. Low state bank minimums were provided in unattractive areas for banking and weren't a real competition there for national banks. Still, our regression approach is robust.



## Exercise 6. Conclusion

We are all used to online banking and getting our money where and when we want to. But in the past it wasn't easy like today. The aim of banks was to provide exchange and to make commerce more easy. They tried to connect places financially.

National banks played an important role in the payment system. They could provide loans and currency in form of national notes. Thus, the exchange of good got comfortable and more simple. They couldn't do long-term loans but could provide working capital to farmers and producers. We found out that the presence of a national bank in an rural county increased production per capita by `10%`. Thus, we can claim that providing working capital played a important role in a growing economy rather then providing debit. Furthermore, we saw that national banks promoted both manufacturing and farm production. Since the United States during the analysed period could be compared to today developing countries, we can assume that the services of national banking played an important role in the development of the USA. Like Fullford says, "Facilitating a payments system, providing working capital, and funding goods in transit are key functions of banks during periods of growth and development".


Finally, you can display all awards that you collected in this problem set. Just press `edit` and `check` afterwards. The maximum number of achievable awards is #nummer einfugen.

```{r "6__Conclusion",optional=TRUE}
awards()
```



## Exercise 7. References

### Bibliography

### R Packages

- Gaure, S. (2016): *lfe*. *Linear Group Fixed Effects*. R package version 2.5-1998. https://cran.r-project.org/web/packages/lfe/lfe.pdf.

- Hlavac, M. (2015): *stargazer*. *Well-Formatted Regression and Summary Statistics Tables*. R package version 5.2. https://cran.r-project.org/web/packages/stargazer/stargazer.pdf.

- Hothorn, T., Zeileis, A., Farebrother, R. W. and Cummins, C. (2017): *lmtest*. *Testing Linear Regression Models*. R package version 0.9-35. https://cran.r-project.org/web/packages/lmtest/lmtest.pdf.

- Kranz, S. (2015): *RTutor*. *R Problem Sets with Automatic Test of Solution and Hints*. R package version 2015.12.16. https://github.com/skranz/RTutor.

- Wickham, H. and Chang, W. (2016): *ggplot2*. *Create Elegant Data Visualisations Using the Grammar of Graphics*. R package version 2.2.1. https://cran.r-project.org/web/packages/ggplot2/ggplot2.pdf.

- Wickham, H., Francois, R., Henry, L. and M&uuml;ller, K. (2017): *dplyr*. *A Grammar of Data Manipulation*. R package version 0.7.3. https://cran.r-project.org/web/packages/dplyr/dplyr.pdf.



### Web Pages

























